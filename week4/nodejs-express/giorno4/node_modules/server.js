const express = require("express");
const app = express();
const PORT = 3000;

// Middleware per leggere JSON dal body
app.use(express.json());

// Finto database
let prodotti = ["Laptop", "Mouse", "Tastiera"];

app.get("/", (req,res) =>{
    res.send("Benvenuto nella mia api");

})

// READ → Leggi tutti i prodotti
app.get("/prodotti", (req, res) => {
  res.json(prodotti);
});

// CREATE → Aggiungi un nuovo prodotto
app.post("/prodotti", (req, res) => {
  const nuovoProdotto = req.body.nome;
  if (!nuovoProdotto) {
    return res.status(400).json({ errore: "Nome prodotto mancante" });
  }
  prodotti.push(nuovoProdotto);
  res.status(201).json(prodotti);
});

// UPDATE → Modifica un prodotto esistente
app.put("/prodotti/:id", (req, res) => {
  const id = req.params.id;
  const nuovoNome = req.body.nome;

  if (!prodotti[id]) {
    return res.status(404).json({ errore: "Prodotto non trovato" });
  }

  prodotti[id] = nuovoNome;
  res.json(prodotti);
});

// DELETE → Elimina un prodotto
app.delete("/prodotti/:id", (req, res) => {
  const id = req.params.id;

  if (!prodotti[id]) {
    return res.status(404).json({ errore: "Prodotto non trovato" });
  }

  prodotti.splice(id, 1);
  res.json(prodotti);
});

app.listen(PORT, () => {
  console.log(`Server attivo su http://localhost:${PORT}`);
});
