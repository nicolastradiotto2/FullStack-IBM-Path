const express = require("express");
const app = express();
const PORT = 3000;

// Middleware → serve per leggere JSON dal body
app.use(express.json());

// Array di esempio (finto "database")
let prodotti = ["Laptop", "Mouse", "Tastiera"];

// Rotta base
app.get("/", (req, res) => {
  res.send("Benvenuto nella mia API");
});

// Rotta prodotti (lista completa)
app.get("/prodotti", (req, res) => {
  res.json(prodotti);
});

// Rotta contatti (rimasta come esempio dal giorno 2)
app.get("/contatti", (req, res) => {
  const contatti = [
    { nome: "Mario", telefono: "123456789" },
    { nome: "Lucia", telefono: "987654321" }
  ];
  res.json(contatti);
});

// POST → aggiungo un nuovo prodotto
app.post("/prodotti", (req, res) => {
  const nuovoProdotto = req.body.nome; // leggo "nome" dal body
  prodotti.push(nuovoProdotto);        // lo aggiungo all'array
  res.json(prodotti);                  // restituisco la lista aggiornata
});

// GET con parametro dinamico → es: /prodotti/1
app.get("/prodotti/:id", (req, res) => {
  const id = req.params.id;     // prendo il parametro dall’URL
  const prodotto = prodotti[id]; 

  if (prodotto) {
    res.send(`Hai chiesto il prodotto: ${prodotto}`);
  } else {
    res.status(404).send("Prodotto non trovato ❌");
  }
});

app.listen(PORT, () => {
  console.log(`Server attivo su http://localhost:${PORT}`);
});
